#!/bin/bash

# FIXME: Some of this should be in `~/.xsession`, but that doesn't seem to work on Ubuntu 23.04.
#
#   `~/.xsessionrc` is a Debian extension -- see `man 5 Xsession` Ubuntu's start up procedure.
#   The former is intended to provide a place to inject environment variables that should be
#   available to all graphical sessions, though it can also be used to run things like `xrandr`
#   or start daemons that are desired to happen before all graphical sessions.
#
#   `exec`-ing at the bottom here stops later start-up scripts from being reached (so you don't
#   get things like an SSH or GPG agent, or other things added by installed packages); it also
#   means that the display manager's choice of session type is ignored: this user will always
#   get the one started here.  (Even if this were in `~/.xsession`, the DM's choice would be
#   ignored -- which is the point of that file -- but it would only be `exec`-ed after the
#   other start up scripts had completed.)


# Arrange displays.
xrandr \
    --output eDP-1 --auto --pos 0x1360 \
    --output HDMI-1-0 --auto --pos 1920x0 --rotate left \
    --output DP-1-0 --auto --pos 3360x420


# Put Jeo on Kinesis.
xinput --list \
    | grep Kinesis \
    | grep -Ev 'Control|pointer' \
    | grep -Po '(?<=id=)[0-9]+'  \
    | xargs -I device_id xkbcomp -i device_id ~/.config/xkb/keymap.xkm $DISPLAY


# Restore previously set background, from e.g. `feh --bg-fill /usr/share/backgrounds/Some_Included_Image.png`.
~/.fehbg


exec xmonad
